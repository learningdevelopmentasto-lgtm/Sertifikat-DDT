<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Daftar Sertifikat Lulus Pelatihan DDT</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 2rem;
      background: #f9f9f9;
    }
    h1 {
      text-align: center;
      color: #333;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 2rem;
    }
    th, td {
      padding: 0.75rem;
      border: 1px solid #ccc;
      text-align: center;
    }
    th {
      background-color: #0080ff;
      color: white;
    }
    .error {
      color: red;
      text-align: center;
      margin-top: 1rem;
    }
  </style>
</head>
<body>

<h1>Daftar Sertifikat Lulus Pelatihan DDT</h1>
<table id="sertifikatTable">
  <thead>
    <tr>
      <th>No</th>
      <th>Nama</th>
      <th>NRP</th>
      <th>Perusahaan</th>
      <th>Nilai</th>
      <th>Link Sertifikat</th>
    </tr>
  </thead>
  <tbody id="tableBody"></tbody>
</table>

<div class="error" id="errorMessage"></div>

<script>
  // Ganti ID ini dengan ID file JSON kamu di Google Drive
  const fileId = "1XrYEAuyftjTB_-Dx8GrSvoIQVafMumSb"; // <== GANTI DENGAN ID ASLI
  const url = `https://drive.google.com/uc?export=download&id=1XrYEAuyftjTB_-Dx8GrSvoIQVafMumSb$`;

  fetch(url)
    .then(response => response.json())
    .then(data => {
      const tbody = document.getElementById("tableBody");
      let no = 1;
      let found = false;

      data.forEach(peserta => {
        if (peserta.status === "Lulus") {
          found = true;
          const row = document.createElement("tr");
          row.innerHTML = `
            <td>${no++}</td>
            <td>${peserta.nama}</td>
            <td>${peserta.nrp}</td>
            <td>${peserta.perusahaan}</td>
            <td>${peserta.nilai ?? "-"}</td>
            <td>${
              peserta.link
                ? `<a href="${peserta.link}" target="_blank">Lihat Sertifikat</a>`
                : "Belum tersedia"
            }</td>
          `;
          tbody.appendChild(row);
        }
      });

      if (!found) {
        document.getElementById("errorMessage").textContent = "Belum ada data sertifikat yang tersedia.";
      }
    })
    .catch(error => {
      document.getElementById("errorMessage").textContent = "Gagal memuat data sertifikat.";
      console.error(error);
    });
</script>

</body>
</html>
